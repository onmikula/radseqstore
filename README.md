# radseqstore
A storage room for scripts and functions used for analyses of (dd)RAD sequences.

The bash scripts were written for computations at machines of MetaCentrum, the Czech academic computational grid (https://metavo.metacentrum.cz). They can contain some features, that are specific to this computational grid and, thus, need to be modified appropriately before being used elsewhere. The same applies to paths included in the scripts as they don't match the directory structure of this repository. All the scripts are shortly commented below. The embedded R scripts may require specific packages or custom functions, which are provided at the same place.

**seq-from-reference-genome**
takes alignments of RAD loci and the reference genome that was used for their assembly and for each of the loci it extracts the corresponding part of the reference genome and attaches these sequences to the alignments. The arguments are: (1) reference genome (either a gzipped file or a directory containing genome already indexed by bwa software); (2) sequence file, i.e., full phased sequences of RAD loci; (3) software used for the assembly and hence the format of the sequence file ('ipyrad' or 'stacks'). The script outputs: (A) RAD loci alignments enriched by the reference genome sequences in .nexus format; (B) reference genome sequences at RAD loci in .fasta format and (C) .bed table with reference genome coordinates of the loci as recorded in the input sequence file.

**seq-from-outgroup-genome**
takes alignments of RAD loci and an outgroup genome and for each of the alignments it finds consensus sequence, map it to the outgroup genome and aligns the corresponding sequence to sequences of the locus. The arguments are: (1) outgroup genome (either a gzipped file or a directory containing genome already indexed by bwa software); (2) sequence file, i.e., full phased sequences of RAD loci; (3) the format of the sequence file (could 'ipyrad', 'stacks', 'nexus' or 'fasta'). (4) optionally, the consenus file containing consensus sequences of RAD loci in .fasta format. The script also outputs bed table with reference genome coordinates of the loci as recorded in the sequence file. The script outputs: (A) RAD loci alignments enriched by the outgroup genome sequences in .nexus format; (B) outgroup genome sequences at RAD loci in .fasta format; (C) consensus sequences of RAD loci in .fasta format; (D) .bam file with mapping of consensus sequences to the outgroup genome and (E) .bed table with reference genome coordinates of the loci. The RAD loci alignments and bed table (A, E) come in two forms - unfiltered and filtered, the latter containing only loci, which succesfully mapped to unique locations in the outgroup genome. 
